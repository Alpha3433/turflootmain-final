(()=>{var e={};e.id=9156,e.ids=[9156],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},98188:e=>{"use strict";e.exports=require("module")},41808:e=>{"use strict";e.exports=require("net")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},87503:e=>{"use strict";e.exports=require("node:net")},49411:e=>{"use strict";e.exports=require("node:path")},84492:e=>{"use strict";e.exports=require("node:stream")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},71267:e=>{"use strict";e.exports=require("worker_threads")},59796:e=>{"use strict";e.exports=require("zlib")},99326:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>d,pages:()=>u,routeModule:()=>x,tree:()=>c}),r(37763),r(97380),r(20784),r(41888);var s=r(23191),n=r(88716),a=r(37922),i=r.n(a),o=r(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["spectate",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,37763)),"/app/frontend/app/spectate/page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,97380)),"/app/frontend/app/layout.js"],error:[()=>Promise.resolve().then(r.bind(r,20784)),"/app/frontend/app/error.js"],"not-found":[()=>Promise.resolve().then(r.bind(r,41888)),"/app/frontend/app/not-found.js"]}],u=["/app/frontend/app/spectate/page.js"],d="/spectate/page",m={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/spectate/page",pathname:"/spectate",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},40166:(e,t,r)=>{Promise.resolve().then(r.bind(r,95888))},95888:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var s=r(10326),n=r(17577),a=r(35047),i=r(49200),o=r(18729),l=r(50560),c=r(58648),u=r(79361),d=r(64296);let m=({roomId:e,gameMode:t="free",entryFee:r=0,stake:m="FREE"})=>{let x=(0,n.useRef)(null),p=(0,n.useRef)(null),h=(0,n.useRef)(),g=(0,n.useRef)(null),f=(0,a.useRouter)(),{user:b,getAccessToken:y}=(0,i.s)(),[j,v]=(0,n.useState)(!1),[k,w]=(0,n.useState)(null),[N,D]=(0,n.useState)([]),[E,q]=(0,n.useState)(0),[F,C]=(0,n.useState)(null),[_,A]=(0,n.useState)(0),[S,P]=(0,n.useState)(0),[M,R]=(0,n.useState)(!1),[T,B]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=()=>{R(/Mobi|Android/i.test(navigator.userAgent)||window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,n.useEffect)(()=>{if(!e)return;let t=!0;return(async()=>{try{let r=b?await y():null;if(!t)return;let s=io("/",{transports:["websocket","polling"],autoConnect:!0,reconnection:!0,reconnectionDelay:2e3,reconnectionAttempts:5,timeout:1e4});p.current=s,g.current=setTimeout(()=>{if(!j){console.error("‚ùå Connection timeout - falling back to demo mode"),B("Connection timeout"),v(!0);let e=[{id:"demo1",nickname:"Demo Bot 1",x:100,y:100,mass:50,alive:!0,kills:2,deaths:0},{id:"demo2",nickname:"Demo Bot 2",x:-100,y:-100,mass:75,alive:!0,kills:1,deaths:1},{id:"demo3",nickname:"Demo Bot 3",x:200,y:-150,mass:60,alive:!0,kills:0,deaths:2}],t=[];for(let e=0;e<50;e++)t.push({id:`food_${e}`,x:(Math.random()-.5)*800,y:(Math.random()-.5)*800});let r={timestamp:Date.now(),players:e,food:t,running:!0,worldBounds:{width:1e3,height:1e3,centerX:0,centerY:0},leaderboard:[{rank:1,nickname:"Demo Bot 2",mass:75,kills:1},{rank:2,nickname:"Demo Bot 3",mass:60,kills:0},{rank:3,nickname:"Demo Bot 1",mass:50,kills:2}],spectatorCount:1};w(r),D(e),C(e[0]),P(e.length),A(1)}},1e4),s.on("connect",()=>{t&&(console.log("\uD83D\uDC41Ô∏è Socket connected, joining as spectator..."),console.log("\uD83D\uDC41Ô∏è Testing simple connection..."),s.emit("join_as_spectator",{roomId:e,token:r||"guest"}),console.log("\uD83D\uDC41Ô∏è Sent join_as_spectator event for room:",e))}),s.on("spectator_joined",e=>{t&&(console.log("\uD83D\uDC41Ô∏è Successfully joined as spectator:",e),g.current&&(clearTimeout(g.current),g.current=null),v(!0),A(e.spectatorCount||0),P(e.playerCount||0))}),s.on("spectator_join_failed",e=>{t&&(console.error("‚ùå Failed to join as spectator:",e),v(!1))}),s.on("spectator_join_error",e=>{t&&(console.error("‚ùå Spectator join error:",e),v(!1))}),s.on("auth_error",e=>{t&&(console.error("‚ùå Authentication error:",e),v(!1))}),s.on("spectator_game_state",e=>{if(t){if(w(e),e.players){let t=e.players.filter(e=>e.alive);if(D(t),P(t.length),t.length>0&&(!F||!t.find(e=>e.id===F.id))){let e=t.sort((e,t)=>(t.mass||0)-(e.mass||0))[0];C(e),q(0),console.log(`üëÅÔ∏è Following: ${e.nickname}`)}}void 0!==e.spectatorCount&&A(e.spectatorCount)}}),s.on("spectator_count_update",e=>{t&&A(e.spectatorCount||0)}),s.on("disconnect",()=>{t&&(console.log("\uD83D\uDC41Ô∏è Spectator disconnected"),v(!1),w(null))})}catch(e){t&&console.error("‚ùå Failed to initialize spectator:",e)}})(),()=>{t=!1,g.current&&(clearTimeout(g.current),g.current=null),p.current&&(p.current.removeAllListeners(),p.current.disconnect(),p.current=null)}},[e,b,y]);let $=(0,n.useCallback)(e=>{let t=x.current;if(!t||!k||!F){h.current=requestAnimationFrame($);return}let r=t.getContext("2d");(t.width!==t.offsetWidth||t.height!==t.offsetHeight)&&(t.width=t.offsetWidth,t.height=t.offsetHeight);let s=F.x||0,n=F.y||0;r.clearRect(0,0,t.width,t.height),r.save(),r.translate(t.width/2,t.height/2),r.scale(2.5,2.5),r.translate(-s,-n),k.worldBounds&&(r.strokeStyle="#333",r.lineWidth=1.2,r.strokeRect(-k.worldBounds.width/2,-k.worldBounds.height/2,k.worldBounds.width,k.worldBounds.height)),k.food&&Array.isArray(k.food)&&k.food.forEach(e=>{e&&"number"==typeof e.x&&"number"==typeof e.y&&(r.fillStyle="#FFD700",r.beginPath(),r.arc(e.x,e.y,4,0,2*Math.PI),r.fill())}),k.players&&Array.isArray(k.players)&&k.players.forEach(e=>{if(!e||!e.alive||"number"!=typeof e.x||"number"!=typeof e.y)return;let t=2*Math.sqrt(e.mass||10),s=e.id===F.id;r.fillStyle=s?"#00FF00":"#3B82F6",r.beginPath(),r.arc(e.x,e.y,t,0,2*Math.PI),r.fill(),r.strokeStyle=s?"#FFFF00":"#FFF",r.lineWidth=s?1.2:.8,r.stroke(),e.nickname&&(r.fillStyle=s?"#FFFF00":"#FFF",r.font="12px Arial",r.textAlign="center",r.fillText(e.nickname,e.x,e.y-t-8)),r.fillStyle=s?"#FFFF00":"#FFD700",r.font="10px Arial",r.fillText(`${Math.floor(e.mass||0)}`,e.x,e.y+t+10)}),r.restore(),h.current=requestAnimationFrame($)},[k,F]);(0,n.useEffect)(()=>(k&&F&&x.current&&(h.current=requestAnimationFrame($)),()=>{h.current&&cancelAnimationFrame(h.current)}),[$,k,F]);let z=()=>{if(0===N.length)return;let e=(E+1)%N.length;q(e),C(N[e]),console.log(`üëÅÔ∏è Cycling to: ${N[e].nickname}`)},Z=async()=>{if(!b&&r>0){console.log("\uD83D\uDD10 Authentication required for paid games");return}try{console.log("\uD83C\uDFAE Joining match...");let s=`/agario?roomId=${e}&mode=${t}&fee=${r}`;f.push(s)}catch(e){console.error("‚ùå Failed to join match:",e)}};return j?(0,s.jsxs)("div",{className:"min-h-screen bg-black relative overflow-hidden",children:[s.jsx("canvas",{ref:x,className:"w-full h-full absolute inset-0"}),s.jsx("div",{className:"absolute top-4 left-4 z-10",children:s.jsx(l.Zb,{className:"bg-black/80 border-gray-600",children:(0,s.jsxs)(l.aY,{className:"p-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-white mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx(c.Z,{className:"h-4 w-4 text-blue-400"}),(0,s.jsxs)("span",{children:[_," watching"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[s.jsx(u.Z,{className:"h-4 w-4 text-green-400"}),(0,s.jsxs)("span",{children:[S," playing"]})]}),s.jsx("div",{className:"text-yellow-400 font-bold",children:"FREE"===m?"PRACTICE":`$${m} CASH`})]}),(0,s.jsxs)(o.z,{onClick:()=>{f.push("/")},variant:"secondary",size:"sm",className:"bg-black/80 border-gray-600 text-white hover:bg-gray-700 w-full",children:[s.jsx(d.Z,{className:"h-4 w-4 mr-1"}),"Exit to Menu"]})]})})}),F&&s.jsx("div",{className:"absolute top-4 right-4 z-10",children:s.jsx(l.Zb,{className:"bg-black/80 border-yellow-500/50",children:(0,s.jsxs)(l.aY,{className:"p-3",children:[s.jsx("div",{className:"text-yellow-400 font-bold text-lg",children:F.nickname}),(0,s.jsxs)("div",{className:"text-white text-sm",children:["Mass: ",Math.floor(F.mass||0)]}),(0,s.jsxs)("div",{className:"text-gray-400 text-xs",children:["Player ",E+1," of ",N.length]})]})})}),!M&&(0,s.jsxs)("div",{className:"absolute bottom-24 left-1/2 transform -translate-x-1/2 flex gap-4",children:[(0,s.jsxs)("button",{onClick:z,disabled:N.length<=1,className:`px-6 py-3 rounded-lg font-bold transition-all flex items-center gap-2 ${N.length<=1?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-purple-500 hover:bg-purple-400 text-white"}`,children:[s.jsx("span",{className:"text-lg",children:"\uD83D\uDC41Ô∏è"}),(0,s.jsxs)("span",{children:["Next Player (",N.length,")"]})]}),(0,s.jsxs)("button",{onClick:Z,className:"px-6 py-3 rounded-lg font-bold transition-all bg-green-500 hover:bg-green-400 text-white",children:["\uD83C\uDFAE Join Match ","FREE"===m?"- FREE":`- $${m}`]})]}),M&&(0,s.jsxs)("div",{className:"fixed bottom-5 right-5 flex flex-row gap-6 z-50",style:{bottom:"calc(env(safe-area-inset-bottom, 0px) + 30px)",right:"20px"},children:[s.jsx("div",{className:"relative rounded-full flex items-center justify-center cursor-pointer transition-all duration-200 active:scale-95",onClick:z,style:{touchAction:"none",userSelect:"none",WebkitUserSelect:"none",width:"75px",height:"75px",padding:"6px",zIndex:1001},children:(0,s.jsxs)("div",{className:`absolute inset-0 flex flex-col items-center justify-center text-white text-xs font-bold rounded-full border-2 transition-all duration-200 ${N.length<=1?"bg-gray-800/60 border-gray-700":"bg-purple-800/80 border-purple-600 hover:bg-purple-700/90"}`,children:[s.jsx("div",{className:"text-lg",children:"\uD83D\uDC41Ô∏è"}),(0,s.jsxs)("div",{className:"text-center leading-tight",children:[s.jsx("div",{className:"text-xs",children:"NEXT"}),(0,s.jsxs)("div",{className:"text-xs",children:["(",N.length,")"]})]})]})}),s.jsx("div",{className:"relative rounded-full flex items-center justify-center cursor-pointer transition-transform duration-200 active:scale-95",onClick:Z,style:{touchAction:"none",userSelect:"none",WebkitUserSelect:"none",width:"90px",height:"90px",padding:"8px",zIndex:1001},children:(0,s.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-white text-xs font-bold rounded-full border-2 transition-all duration-200 bg-gradient-to-br from-green-400 via-green-500 to-green-600 border-green-400 hover:from-green-300 hover:via-green-400 hover:to-green-500",children:[s.jsx("div",{className:"text-lg",children:"\uD83C\uDFAE"}),(0,s.jsxs)("div",{className:"text-center leading-tight",children:[s.jsx("div",{children:"JOIN"}),s.jsx("div",{className:"text-xs",children:"FREE"===m?"FREE":`$${m}`})]})]})})]}),!k&&j&&s.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-20",children:s.jsx(l.Zb,{className:"bg-black/80 border-gray-700",children:(0,s.jsxs)(l.aY,{className:"p-6 text-center",children:[s.jsx(c.Z,{className:"h-8 w-8 text-blue-500 mx-auto mb-2 animate-pulse"}),s.jsx("p",{className:"text-white",children:"Waiting for game data..."})]})})})]}):s.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:s.jsx(l.Zb,{className:"w-96 bg-black/80 border-gray-700",children:(0,s.jsxs)(l.aY,{className:"p-8 text-center",children:[(0,s.jsxs)("div",{className:"relative",children:[s.jsx(c.Z,{className:"h-16 w-16 text-blue-400 mx-auto mb-6 animate-pulse"}),s.jsx("div",{className:"absolute -inset-2 bg-blue-400/20 rounded-full animate-ping"})]}),s.jsx("h2",{className:"text-2xl font-bold mb-3 text-white",children:"FREE"===m?"Entering Practice Match...":`Entering $${m} Match...`}),s.jsx("p",{className:"text-gray-400 mb-4",children:T?"Connection issue - starting demo mode...":"FREE"===m?"Connecting to practice game...":`Connecting to $${m} cash game...`}),s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("div",{className:"w-8 h-1 bg-blue-400 rounded animate-pulse"})}),s.jsx(o.z,{onClick:()=>{console.log("\uD83D\uDC41Ô∏è Manual connection fallback"),v(!0);let e=[{id:"demo1",nickname:"Demo Bot 1",x:100,y:100,mass:50,alive:!0,kills:2,deaths:0},{id:"demo2",nickname:"Demo Bot 2",x:-100,y:-100,mass:75,alive:!0,kills:1,deaths:1},{id:"demo3",nickname:"Demo Bot 3",x:200,y:-150,mass:60,alive:!0,kills:0,deaths:2}],t=[];for(let e=0;e<50;e++)t.push({id:`food_${e}`,x:(Math.random()-.5)*800,y:(Math.random()-.5)*800});w({timestamp:Date.now(),players:e,food:t,running:!0,worldBounds:{width:1e3,height:1e3,centerX:0,centerY:0},leaderboard:[{rank:1,nickname:"Demo Bot 2",mass:75,kills:1},{rank:2,nickname:"Demo Bot 3",mass:60,kills:0},{rank:3,nickname:"Demo Bot 1",mass:50,kills:2}],spectatorCount:1}),D(e),C(e[0]),P(e.length),A(1)},className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Continue Anyway"})]})})})};function x(){let e=(0,a.useSearchParams)(),t=e.get("roomId"),r=e.get("mode")||"free",n=parseFloat(e.get("fee"))||0;e.get("autoSpectate");let i=e.get("stake")||(0===n?"FREE":n.toString());return t?s.jsx(m,{roomId:t,gameMode:r,entryFee:n,stake:i}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 flex items-center justify-center",children:s.jsx(l.Zb,{className:"w-96",children:(0,s.jsxs)(l.aY,{className:"p-6 text-center",children:[s.jsx(c.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-bold mb-2",children:"Invalid Spectator Request"}),s.jsx("p",{className:"text-muted-foreground",children:"No room ID provided. Please return to the lobby and try again."})]})})})}function p(){return s.jsx(n.Suspense,{fallback:s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 flex items-center justify-center",children:s.jsx(l.Zb,{className:"w-96",children:(0,s.jsxs)(l.aY,{className:"p-6 text-center",children:[s.jsx(c.Z,{className:"h-12 w-12 text-blue-500 mx-auto mb-4 animate-pulse"}),s.jsx("h2",{className:"text-xl font-bold mb-2",children:"Loading Spectator Mode..."}),s.jsx("p",{className:"text-muted-foreground",children:"Preparing your spectator experience..."})]})})}),children:s.jsx(x,{})})}},35047:(e,t,r)=>{"use strict";var s=r(77389);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},37763:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>o});var s=r(68570);let n=(0,s.createProxy)(String.raw`/app/frontend/app/spectate/page.js`),{__esModule:a,$$typeof:i}=n;n.default;let o=(0,s.createProxy)(String.raw`/app/frontend/app/spectate/page.js#default`)},49200:(e,t,r)=>{"use strict";r.d(t,{s:()=>d});var s=r(17577),n=r(44732),a=r(8742),i=r(36032);let o=async({emitPrivyEvent:e,getAccessToken:t,initializeWalletProxy:r,refreshUser:s,user:n},{privateKey:o,chainType:l})=>{if(!n)throw e("linkAccount","onError",i.sX.MUST_BE_AUTHENTICATED,{linkMethod:"siwe"}),new i.dx("User must be authenticated before linking an account.");let[c,u]=await Promise.all([t(),r(15e3)]);if(!u||!c)throw e("linkAccount","onError",i.sX.MUST_BE_AUTHENTICATED,{linkMethod:"siwe"}),new i.dx("User must be authenticated before linking an account.");await u.importWallet({privateKey:o,accessToken:c,chainType:l});let d=await s(),m="solana"===l?(0,a.Ry)(d):(0,a.Nc)(d);if(!m)throw e("createWallet","onError",i.sX.UNKNOWN_EMBEDDED_WALLET_ERROR),Error("Failed to import wallet");return e("createWallet","onSuccess",m),m};var l=r(71139),c=r(89974);let u=()=>{let{getAccessToken:e,user:t}=(0,n.b)(),{refreshUser:r,initializeWalletProxy:a}=(0,c.u)(),i=(0,l.rN)();return{importWallet:(0,s.useCallback)(({privateKey:s})=>o({getAccessToken:e,user:t,initializeWalletProxy:a,refreshUser:r,emitPrivyEvent:i},{privateKey:s,chainType:"ethereum"}),[t,e,r,a,i])}},d=()=>{let{importWallet:e}=u();return{...(0,s.useContext)(n.N),importWallet:e}}},64296:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(87926).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},58648:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(87926).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},79361:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(87926).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,7603,4002,946],()=>r(99326));module.exports=s})();