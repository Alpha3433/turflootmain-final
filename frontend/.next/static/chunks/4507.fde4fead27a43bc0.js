"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4507],{4507:function(o,e,n){n.d(e,{joinArena:function(){return r}});var s=n(32609);class t{async joinArena(o){let{privyUserId:e,playerName:n=null}=o;try{return console.log("\uD83D\uDE80 Connecting to Colyseus Cloud server..."),this.client=new s.KU(this.endpoint),this.room=await this.client.joinOrCreate("arena",{privyUserId:e,playerName:n||"Player_".concat(Math.random().toString(36).substring(7))}),this.isConnected=!0,console.log("✅ Connected to Colyseus Cloud arena room"),console.log("\uD83C\uDFAE Room ID: ".concat(this.room.roomId)),console.log("\uD83D\uDC65 Session ID: ".concat(this.room.sessionId)),this.setupEventListeners(),this.room}catch(o){throw console.error("❌ Failed to connect to Colyseus Cloud server:",o),this.isConnected=!1,o}}setupEventListeners(){this.room&&(this.room.onStateChange(o=>{if(console.log("\uD83D\uDCCA Arena state updated"),o){var e,n,s;console.log("\uD83D\uDC65 Players: ".concat((null===(e=o.players)||void 0===e?void 0:e.size)||0)),console.log("\uD83E\uDE99 Coins: ".concat((null===(n=o.coins)||void 0===n?void 0:n.size)||0)),console.log("\uD83E\uDDA0 Viruses: ".concat((null===(s=o.viruses)||void 0===s?void 0:s.size)||0))}}),this.room.onStateChange.once(o=>{o&&o.players&&(o.players.onAdd=(o,e)=>{console.log("\uD83D\uDC4B Player joined: ".concat(o.name||"Unknown"," (").concat(e,")"))},o.players.onRemove=(o,e)=>{console.log("\uD83D\uDC4B Player left: ".concat(e))},o.players.onChange=(o,e)=>{console.log("\uD83D\uDD04 Player updated: ".concat(e))}),o&&o.coins&&(o.coins.onAdd=(o,e)=>{console.log("\uD83E\uDE99 Coin spawned: ".concat(e))},o.coins.onRemove=(o,e)=>{console.log("\uD83E\uDE99 Coin collected: ".concat(e))}),o&&o.viruses&&(o.viruses.onAdd=(o,e)=>{console.log("\uD83E\uDDA0 Virus spawned: ".concat(e))},o.viruses.onRemove=(o,e)=>{console.log("\uD83E\uDDA0 Virus removed: ".concat(e))})}),this.room.onMessage("gameState",o=>{console.log("\uD83C\uDFAE Game state message:",o)}),this.room.onMessage("playerJoined",o=>{console.log("\uD83D\uDC64 Player joined:",o)}),this.room.onMessage("playerLeft",o=>{console.log("\uD83D\uDC4B Player left:",o)}),this.room.onError((o,e)=>{console.error("\uD83D\uDEA8 Room error:",o,e)}),this.room.onLeave(o=>{console.log("\uD83D\uDEAA Left room with code:",o),this.isConnected=!1}))}sendInput(o,e,n){if(!this.room||!this.isConnected){console.warn("⚠️ Cannot send input: not connected to room");return}this.room.send("input",{seq:o,dx:e,dy:n})}sendPing(){this.room&&this.isConnected&&this.room.send("ping",{timestamp:Date.now()})}leave(){this.room&&(this.room.leave(),this.room=null),this.isConnected=!1,console.log("\uD83D\uDC4B Disconnected from Colyseus Cloud server")}getGameState(){var o;return(null===(o=this.room)||void 0===o?void 0:o.state)||null}getPlayer(o){var e,n,s;return(null===(s=this.room)||void 0===s?void 0:null===(n=s.state)||void 0===n?void 0:null===(e=n.players)||void 0===e?void 0:e.get(o))||null}getCurrentPlayer(){var o;return this.getPlayer(null===(o=this.room)||void 0===o?void 0:o.sessionId)}getAllPlayers(){var o,e;if(!(null===(e=this.room)||void 0===e?void 0:null===(o=e.state)||void 0===o?void 0:o.players))return[];let n=[];return this.room.state.players.forEach((o,e)=>{n.push({...o,sessionId:e})}),n}getLeaderboard(){return this.getAllPlayers().filter(o=>o.alive).sort((o,e)=>e.score-o.score).slice(0,10).map(o=>({name:o.name,score:o.score,mass:Math.round(o.mass)}))}constructor(){this.client=null,this.room=null,this.isConnected=!1,this.endpoint="wss://au-syd-ab3eaf4e.colyseus.cloud",console.log("\uD83C\uDFAE TurfLoot Colyseus Client initialized"),console.log("\uD83D\uDD17 Colyseus Cloud Endpoint: ".concat(this.endpoint))}}let l=new t,r=o=>{let{privyUserId:e,playerName:n}=o;return l.joinArena({privyUserId:e,playerName:n})}}}]);